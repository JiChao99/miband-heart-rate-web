# 小米手环心率网页版

> 🌐 基于 [Tnze/miband-heart-rate](https://github.com/Tnze/miband-heart-rate) 的纯网页版小米手环心率监控器

一个基于Web蓝牙API的网页应用，用于从小米智能手环设备实时读取心率数据。无需安装任何软件——直接在浏览器中打开即可！

**🚀 在线演示:** [https://jichao99.github.io/miband-heart-rate-web/](https://jichao99.github.io/miband-heart-rate-web/)

**📖 English Version:** [README.md](./README.md)

## ✨ 特性

- 🔗 **浏览器直连** - 无需安装应用程序
- 💖 **实时心率监控** - 动态显示实时心率数据（BPM）
- 📊 **传感器接触检测** - 显示手环是否正确佩戴
- 🎨 **精美界面** - 现代渐变设计，流畅动画效果
- 🔄 **自动重连** - 优雅处理连接断开
- 📱 **移动端友好** - 同样适用于移动浏览器
- 🔧 **调试模式** - 高级调试功能，包含连接日志和统计信息
- 🌐 **双语支持** - 支持中文和英文界面切换
- 📺 **画中画模式** - 支持画中画显示心率数据

## 🚀 快速开始

1. **启用小米手环心率广播**:
   - 进入小米手环设置 → 心率 → 开启"心率广播"

2. **打开网页应用**:
   - 通过HTTPS服务器提供文件（Web蓝牙要求）
   - 或者直接在Chrome/Edge中打开 `index.html`

3. **连接设备**:
   - 点击"连接小米手环"
   - 从蓝牙对话框中选择你的设备
   - 开始监控你的心率！

## 🔧 技术要求

### 浏览器支持
- ✅ Chrome 56+ (Windows, macOS, Linux, Android)
- ✅ Edge 79+ (Windows, macOS)
- ❌ Firefox (不支持Web蓝牙)
- ❌ Safari (不支持Web蓝牙)

### 连接要求
- 🔒 **需要HTTPS** (Web蓝牙安全要求)
- 📡 **蓝牙4.0+** 在你的计算机/设备上
- 🏃‍♂️ **启用心率广播的小米手环**

## 📱 支持的设备

**已测试设备:**
- 小米手环 10/NFC ✅

**应该支持的设备:**
- 小米手环 4, 5, 6, 7, 8, 9, 10 (所有支持心率广播的型号)

## 🛠️ 本地开发

### 本地开发服务器

本地开发需要HTTPS。使用以下方法之一：

```bash
# 使用Python 3
python -m http.server 8080 --bind localhost

# 使用Node.js (http-server)
npx http-server -p 8080 -a localhost

# 使用PHP
php -S localhost:8080

# 使用本项目提供的Node.js服务器
node server.js
```

然后通过 `http://localhost:8080` 访问（对于本地开发，HTTP也可以工作）。

注意：画中画功能需要HTTPS环境。

### 文件结构
```
miband-heart-rate-web/
├── index.html          # 主要HTML界面
├── script.js           # Web蓝牙实现和国际化
├── server.js           # 本地开发服务器
├── README.md           # 英文文档
├── README.zh.md        # 中文文档（本文件）
└── ...
```

## 🔌 Web蓝牙实现

本实现使用Web蓝牙API复制了Rust版本的功能：

- **心率服务UUID**: `0x180D`
- **心率测量UUID**: `0x2A37`
- **数据解析**: 与原始Rust代码相同的位字段解析
- **自动重连**: 像原始版本的循环一样处理连接断开

## 🌐 国际化支持

应用支持中英文双语：

- 🔍 **自动检测**: 根据浏览器语言自动选择界面语言
- 🔄 **手动切换**: 点击🌐按钮在中英文之间切换
- 💾 **记住选择**: 语言偏好自动保存到本地存储
- 🎯 **完整翻译**: 所有UI文本、错误消息和调试信息都支持双语

## 📺 画中画功能

支持画中画模式显示心率数据：

- 🖼️ **实时显示**: 在小窗口中显示实时心率
- 🎨 **美观界面**: 渐变背景和清晰字体
- 💖 **可选图标**: 可选择显示或隐藏心形图标
- ⌨️ **快捷键**: Ctrl+P 切换画中画模式
- 🔒 **安全要求**: 需要HTTPS环境

## 🆚 与原版对比

| 功能 | Rust版本 | 网页版本 |
|---------|-------------|-------------|
| 平台 | Windows/macOS/Linux | 任何现代浏览器 |
| 安装 | 从源码编译 | 无需安装 |
| 蓝牙API | bluest crate | Web蓝牙API |
| 界面 | 终端输出 | 精美网页界面 |
| 心率显示 | 仅文本 | 动画+BPM显示 |
| 传感器接触 | 文本输出 | 可视化指示器 |
| 重连机制 | 自动循环 | 自动重连逻辑 |
| 语言支持 | 单语言 | 中英文双语 |
| 画中画 | 无 | 支持PiP模式 |

## 🐛 常见问题

### "不支持Web蓝牙"
- 使用Chrome或Edge浏览器
- 确保使用HTTPS（非HTTP）

### "蓝牙不可用"
- 启用设备蓝牙
- 在提示时授予蓝牙权限

### "找不到设备"
- 确保小米手环心率广播已启用
- 确保小米手环未连接到其他应用
- 尝试重启设备蓝牙

### "画中画不工作"
- 确保使用HTTPS协议
- Chrome: 启用 `chrome://flags/#allow-insecure-localhost`
- Edge: 启用 `edge://flags/#allow-insecure-localhost`

### 连接频繁断开
- 保持小米手环靠近你的设备
- 确保小米手环有足够电量
- 关闭可能干扰的其他蓝牙应用

## 💡 使用技巧

### 快捷键
- `Ctrl + P`: 切换画中画模式
- `Ctrl + H`: 切换画中画心形图标（画中画模式下）

### 调试模式
启用调试模式可以：
- 查看详细连接日志
- 监控心率更新统计
- 在未连接设备时测试画中画功能

### 语言切换
- 点击🌐按钮在中英文之间切换
- 语言设置会自动保存
- 首次访问根据浏览器语言自动选择

## 📄 开源协议

本项目受到 [Tnze/miband-heart-rate](https://github.com/Tnze/miband-heart-rate) 启发并基于其开发。

## 🤝 贡献

欢迎提交问题和拉取请求来改进这个网页版本！

---

**注意:** 这是原始Rust实现的网页版本。如需原生桌面版本，请查看 [原始仓库](https://github.com/Tnze/miband-heart-rate)。